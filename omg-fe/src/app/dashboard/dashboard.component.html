<ng-container *ngIf='role === 0; then adminTemplate else userTemplate'></ng-container>


<ng-template #userTemplate>
  <div class="card">
    <p-menubar [model]="menuItems">
        <ng-template pTemplate="start">
            <img src="https://primefaces.org/cdn/primeng/images/primeng.svg" height="40" class="mr-2" />
  
        </ng-template>
        <ng-template pTemplate="end">
          <div class="timer">
              Đồng hồ: {{this.currentTime | date: 'HH:mm:ss'}} GMT+7 <br>
              Xin chào người dùng {{user.name}}
  
          </div>
          
            <!--input type="text" pInputText placeholder="Search" class="w-full" /-->
        </ng-template>
       
    </p-menubar>
  </div>

</ng-template>

<ng-template  #adminTemplate>
  <div class="card">
    <p-menubar [model]="adminMenuItems">
        <ng-template pTemplate="start">
            <img src="https://primefaces.org/cdn/primeng/images/primeng.svg" height="40" class="mr-2" />
  
        </ng-template>
        <ng-template pTemplate="end">
          <div class="timer">
              Đồng hồ: {{this.currentTime | date: 'HH:mm:ss'}} GMT+7 <br>
              Xin chào quản trị viên {{user.name}}
  
          </div>
          
            <!--input type="text" pInputText placeholder="Search" class="w-full" /-->
        </ng-template>
       
    </p-menubar>
  </div>

</ng-template>

<div class="new-user" *ngIf="showNewUserForm">
  <h3 class="form-title">Tạo người dùng mới</h3>
    <form [formGroup]="newUserForm" class="card flex justify-content-center" id="register-form">
        <div class="flex flex-column gap-2">
            <label htmlFor="username">Tên người dùng</label> <br>
            <input type="text" pInputText name="username" id="username" placeholder="ricky4" formControlName="username"/> 
            <p></p>
        </div>
        <div class="form-group">
            <label htmlFor="name">Họ và tên</label> <br>
            <input type="text" pInputText name="name" id="name" placeholder="Trần Văn D" formControlName="name"/>
            <p></p>
        </div>
        <div class="form-group">
            <label htmlFor="email">Email</label> <br>
            <input type="text" pInputText name="email" id="email" placeholder="ricky4@gmail.com" formControlName="email"/>
            <p></p>
        </div>
        <div class="form-group">
            <label htmlFor="password">Mật khẩu</label> <br>
            <input type="password" pInputText name="pass" id="pass" placeholder="Bí mật" formControlName="password"/>
            <p></p>
        </div>
        <p></p>
        <p-button label="Xác nhận" (click)="onSubmitCreateUser()"></p-button>
        <p-button label="Huỷ" (click)="onCancelCreateUser()"></p-button>
    </form>
</div>

<div class="edit-item" *ngIf="showProfile">
  <h3 class="form-title">Chỉnh sửa thông tin cá nhân</h3>
  <form [formGroup]="profileForm" class="card flex justify-content-center" id="item-editor-form">
      <div class="flex flex-column gap-2">
          <label htmlFor="name">Họ và tên</label> {{this.user.name}} <br>
          <input type="text" *ngIf="editing" pInputText name="name" id="name" formControlName="name"/> 
          <p></p>
      </div>
      <div class="form-group">
          <label htmlFor="address">Địa chỉ</label> {{this.user.address}}<br>
          <input type="text" *ngIf="editing" pInputText name="address" id="address" formControlName="address"/>
          <p></p>
      </div>
      <div class="form-group">
          <label htmlFor="type">Sinh nhật</label> {{this.user.birthday}} <br>
          <p-calendar *ngIf="editing" formControlName="birthday"></p-calendar>
          <!--input type="text" pInputText name="type" id="type" formControlName="type"/-->
          <p></p>
      </div>
      <div class="form-group">
        <label htmlFor="phone">Số điện thoại</label> {{this.user.phone}} <br>
        <input type="text" *ngIf="editing" pInputText name="phone" id="phone" formControlName="phone"/>
        <p></p>
    </div>
      <p-button label="Xác nhận" *ngIf="profileSubmitButton" (click)="onSubmitProfile()"></p-button>
      <p-button label="Chỉnh sửa" *ngIf="profileEditButton" (click)="requestEditProfile()"></p-button>
      <p-button label="Huỷ" (click)="onCancelProfile()"></p-button>
  </form>

</div>

<div *ngIf="hasShowItemForm" class="card-like">
  <form>
    <p>
      Biển số <input type="text" pInputText placeholder="00A0-00000" [(ngModel)]="newItem.plateNumber" name="plateNumber">
    </p>
    <p>
      Nhãn hiệu <input type="text" pInputText placeholder="Honda Wave Alpha" [(ngModel)]="newItem.vendor" name="vendor">
    </p>
    <p>
      Loại phương tiện <input type="text" pInputText placeholder="Xe máy" [(ngModel)]="newItem.type" name="vendor">
    </p>
    <p-button type="submit" (click)="createItem()">Xác nhận</p-button>
    &nbsp;
    <p-button type="submit" (click)="cancelCreateItem()">Huỷ</p-button>

  </form>
</div>

<div *ngIf="hasShowSessionForm" class="card-like">
  <form>
    <p>
     Giá mua thẳng <input type="number" pInputNumber placeholder="Giá mua thẳng" [(ngModel)]="newSession.reversePrice" name="reversePrice"> triệu
    </p>
    <p>
     Giá khởi điểm <input type="number" pInputNumber placeholder="Giá khởi điểm" [(ngModel)]="newSession.initiatePrice" name="initPrice"> triệu
    </p>
    <p>
     Bước nhảy giá <input type="number" pInputNumber placeholder="Bước nhảy giá" [(ngModel)]="newSession.stepPrice" name="stepPrice"> triệu
    </p>
    <p>
     Thời điểm bắt đầu <p-calendar [(ngModel)]="newSession.startTime" name="StartTimePicker" [showTime]="true" [showSeconds]="true"></p-calendar>
    </p>
    <p>
     Thời điểm kết thúc <p-calendar [(ngModel)]="newSession.closeTime" name="CloseTimePicker" [showTime]="true" [showSeconds]="true"></p-calendar>
    </p>

    <form [formGroup]="formGroup">
      Chọn vật phẩm
      <p-dropdown formControlName="itemSelector" [options]="itemList" optionLabel="plateNumber">
          <ng-template let-item pTemplate="item">
              <div>{{ item.id }} - {{ item.plateNumber }}</div>
          </ng-template>
      </p-dropdown>
  </form>
  
    <p-button type="submit" (click)="createSession()">Xác nhận</p-button>
    <p-button type="submit" (click)="cancelCreateSession()">Huỷ</p-button>

  </form>
</div>
<div class="user-container" *ngIf="showUsers">
  <div *ngFor="let user of userList; let i = index">
    <app-user class="user" [userId]="user.id"></app-user>
    <div *ngIf="i%4===3 || i=== userList.length - 1" class="clearfix"></div>
  </div>
</div>

<div class="session-container" *ngIf="showSession">
  <div *ngFor="let session of sessionList; let i = index">
      <app-session class="session" [sessionId]="session.id" ngDefaultControl="true"></app-session>
      <div *ngIf="i%4 === 3 || i === sessionList.length - 1" class="clearfix"></div>
  </div>
</div>

<div class="item-container" *ngIf="showItem" id="item-container">
  <div *ngFor="let item of itemList; let i = index">
    <app-item class="item" [itemId]="item.id"></app-item>
    <div *ngIf="i%4 === 3 || i === itemList.length - 1" class="clearfix"></div>
  </div>
</div>

<div class="card" *ngIf="showTransaction">
  <p-table [value]="transactionList" styleClass="p-datatable-gridlines" [tableStyle]="{ 'min-width': '50rem' }">
    <ng-template pTemplate="caption"> Lịch sử giao dịch </ng-template>
    <ng-template pTemplate="header">
        <tr>
            <th>Id</th>
            <th>Số tiền</th>
            <th>Biển số</th>
            <th>Thời gian</th>
        </tr>
    </ng-template>
    <ng-template pTemplate="body" let-transaction>
        <tr>
            <td>{{ transaction.id }}</td>
            <td>{{ transaction.money }}</td>
            <td>{{ transaction.session.item.plateNumber }}</td>
            <td>{{ transaction.created_at }}</td>
        </tr>
    </ng-template>
    <ng-template pTemplate="summary"> Tổng số tiền đã đặt: {{summary}} </ng-template>
</p-table>
</div>

<div class="card" *ngIf="showOrder">
  <p-table [value]="orderList" styleClass="p-datatable-gridlines" [tableStyle]="{ 'min-width': '50rem' }">
    <ng-template pTemplate="caption"> Đơn hàng đã thắng </ng-template>
    <ng-template pTemplate="header">
        <tr>
            <th>Id</th>
            <th>Số tiền</th>
            <th>Biển số</th>
            <th>Trạng thái</th>
        </tr>
    </ng-template>
    <ng-template pTemplate="body" let-order>
        <tr>
            <td>{{ order.id }}</td>
            <td>{{ order.currentPrice }}</td>
            <td>{{ order.item.plateNumber }}</td>
            <td>{{ order.status }}</td>
        </tr>
    </ng-template>
    <ng-template pTemplate="summery"> Tổng số tiền đã đặt: {{total}} </ng-template>
</p-table>
</div>

<div class="card" *ngIf="showSystemOrder">
  <p-table [value]="systemOrderList" styleClass="p-datatable-gridlines" [tableStyle]="{ 'min-width': '50rem' }">
    <ng-template pTemplate="caption"> Toàn bộ đơn hàng </ng-template>
    <ng-template pTemplate="header">
        <tr>
            <th>Id</th>
            <th>Số tiền</th>
            <th>Biển số</th>
            <th>Trạng thái</th>
            <th>Người thắng</th>
        </tr>
    </ng-template>
    <ng-template pTemplate="body" let-order>
        <tr>
            <td>{{ order.id }}</td>
            <td>{{ order.currentPrice }}</td>
            <td>{{ order.item.plateNumber! }}</td>
            <td>{{ order.status }}</td>
            <td>{{ order.winner.name!}}</td>
        </tr>
    </ng-template>
    <ng-template pTemplate="summery"> Tổng số tiền đã đặt: {{total}} </ng-template>
</p-table>
</div>

<router-outlet></router-outlet>

  

